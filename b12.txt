# 1 - AirPassengers 

library(forecast)
library(tseries)

data("AirPassengers")
str(AirPassengers)
summary(AirPassengers)
start(AirPassengers); end(AirPassengers); frequency(AirPassengers)
head(AirPassengers, 12)


class(AirPassengers)
frequency(AirPassengers)
start(AirPassengers); end(AirPassengers)
cycle(AirPassengers)
sum(is.na(AirPassengers))  # expect 0


plot(AirPassengers,
     main = "Monthly Airline Passengers (1949–1960)",
     ylab = "Passengers (thousands)",
     xlab = "Year", col = "blue", lwd = 2)



adf_result <- adf.test(AirPassengers, alternative = "stationary")
print(adf_result)

kpss_result <- kpss.test(AirPassengers)
print(kpss_result)


log_ap <- log(AirPassengers)

diff_seasonal <- diff(log_ap, lag = 12)

diff_full <- diff(diff_seasonal, differences = 1)

par(mfrow = c(3,1))
plot(log_ap, main = "Log Transformed Series", col = "darkred", ylab="log(Passengers)")
plot(diff_seasonal, main = "After Seasonal Differencing (lag=12)", col = "darkgreen", ylab="diff12(log)")
plot(diff_full, main = "After Regular + Seasonal Differencing", col = "blue", ylab="diff1(diff12(log))")
par(mfrow = c(1,1))


fit_sarima <- auto.arima(AirPassengers,
                         seasonal = TRUE,
                         stepwise = FALSE,
                         approximation = FALSE,
                         trace = TRUE)


summary(fit_sarima)

checkresiduals(fit_sarima)

forecast_sarima <- forecast(fit_sarima, h = 36)

plot(forecast_sarima,
     main = "AirPassengers Forecast: 1961–1963",
     xlab = "Year", ylab = "Passengers (thousands)",
     col = "blue", lwd = 2)
lines(fitted(fit_sarima), col = "red", lty = 2)
legend("topleft", legend = c("Observed", "Fitted", "Forecast"),
       col = c("black", "red", "blue"), lty = c(1,2,1), cex = 0.8)

print(accuracy(forecast_sarima))



# 2 - nottem

data("nottem")
str(nottem)
summary(nottem)
start(nottem); end(nottem)
frequency(nottem)

plot(nottem, main="Monthly Temperatures in Nottingham (1920–1939)",
     ylab="Temperature (°F)", col="blue")



class(nottem)
sum(is.na(nottem))
cycle(nottem)



adf.test(nottem, alternative="stationary")
kpss.test(nottem)


diff_seasonal <- diff(nottem, lag = 12)
plot(diff_seasonal, main="After Seasonal Differencing (lag = 12)",
     col="darkgreen")


fit_nottem <- auto.arima(nottem,
                         seasonal = TRUE,
                         stepwise = FALSE,
                         approximation = FALSE,
                         trace = TRUE)
summary(fit_nottem)


checkresiduals(fit_nottem)


forecast_nottem <- forecast(fit_nottem, h = 36)

plot(forecast_nottem,
     main="Forecast of Nottingham Monthly Temperatures",
     xlab="Year", ylab="Temperature (°F)")
lines(fitted(fit_nottem), col="red", lty=2)
legend("topleft", legend=c("Observed","Fitted","Forecast"),
       col=c("black","red","blue"), lty=c(1,2,1), cex=0.8)

