# 3 - lynx 

data("lynx")
str(lynx)
summary(lynx)
start(lynx); end(lynx); frequency(lynx)

plot(lynx, main="Annual Lynx Trappings in Canada (1821â€“1934)",
     ylab="Number of Lynx Trapped", col="blue")


class(lynx)
sum(is.na(lynx))


log_lynx <- log(lynx)
plot(log_lynx, main="Log-Transformed Lynx Series", col="darkred")


adf.test(log_lynx, alternative="stationary")
kpss.test(log_lynx)


log_diff1 <- diff(log_lynx, differences = 1)
plot(log_diff1, main="First Differenced log(Lynx)", col="darkgreen")



acf(log_diff1)
pacf(log_diff1)


fit_lynx <- auto.arima(log_lynx,
                       seasonal = FALSE,
                       stepwise = FALSE,
                       approximation = FALSE,
                       trace = TRUE)
summary(fit_lynx)


checkresiduals(fit_lynx)


lynx_fc <- forecast(fit_lynx, h = 20)
autoplot(lynx_fc)
